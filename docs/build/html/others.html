<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Changelog" href="changelog.html" /><link rel="prev" title="Access data in RMarkdown" href="access_data_rmarkdown.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Connecting other packages - Cecelia 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Cecelia 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Cecelia 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="missions.html">Missions</a></li>
<li class="toctree-l1"><a class="reference internal" href="access_data_rmarkdown.html">Access data in RMarkdown</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Connecting other packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="connecting-other-packages">
<span id="others"></span><h1>Connecting other packages<a class="headerlink" href="#connecting-other-packages" title="Permalink to this heading">#</a></h1>
<p>We can utilise the data generate in <cite>Cecelia</cite> with other packages for further
detailed downstream analysis. Many of these will be specialised R/python packages.
The idea behind this is that the user can define and verify all their populations
within the GUI while an analyst might want to delve deeper into the structure
and components of these populations.</p>
<p>We have tried to create functions that the conversion between <cite>Cecelia</cite> populations
and other packages is relatively straightforward. These detailed analysis steps
could then be integrated within the <cite>Cecelia</cite> GUI to make them available to
people without scripting/programming knowledge. In this sense we envision that
the package will grow to fit the needs of their users.</p>
<section id="r-packages">
<h2>R packages<a class="headerlink" href="#r-packages" title="Permalink to this heading">#</a></h2>
<section id="spiat">
<h3>SPIAT<a class="headerlink" href="#spiat" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/TrigosTeam/SPIAT">SPIAT</a> is an R-package that simplifies
commonly used spatial analysis methods for multiplex imaging. Here, we use the
example <a class="reference internal" href="msn_spleen_lcmv_confocal.html#msn-spleen-lcmv-confocal"><span class="std std-ref">Mouse spleen confocal after LCMV infection</span></a> to look at populations from conventional
confocal images.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nf">library</span><span class="p">(</span><span class="n">cecelia</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="nf">cciaUse</span><span class="p">(</span><span class="s">&quot;~/cecelia&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># init ccia object</span>
<span class="linenos"> 5</span><span class="n">cciaObj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">initCciaObject</span><span class="p">(</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="n">pID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="n">uID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;6QzZsl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">versionID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">versionID</span><span class="p">,</span><span class="w"> </span><span class="n">initReactivity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span>
<span class="linenos"> 7</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">uIDs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">cciaObjects</span><span class="p">())</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1"># get pops</span>
<span class="linenos">12</span><span class="n">pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">popPaths</span><span class="p">(</span><span class="n">popType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;flow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">includeFiltered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">uIDs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uIDs</span><span class="p">[</span><span class="m">1</span><span class="p">])</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1"># exclude &#39;O&#39; pops</span>
<span class="linenos">15</span><span class="n">pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pops</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="nf">str_match</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/O[0-9]*$&quot;</span><span class="p">))]</span>
<span class="linenos">16</span><span class="n">pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pops</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="nf">str_match</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/nonDebris$&quot;</span><span class="p">))]</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">spe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">spe</span><span class="p">(</span><span class="n">popType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;flow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="n">uIDs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uIDs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># get reference object to show image from set</span>
<span class="linenos"> 2</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">cciaObjects</span><span class="p">(</span><span class="n">uIDs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;NjumBK&quot;</span><span class="p">))[[</span><span class="m">1</span><span class="p">]]</span>
<span class="linenos"> 3</span><span class="n">imPopMap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="nf">imPopMap</span><span class="p">(</span><span class="n">popType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;flow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">includeFiltered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="n">popColours</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sapply</span><span class="p">(</span><span class="n">imPopMap</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="o">$</span><span class="n">colour</span><span class="p">})</span>
<span class="linenos"> 5</span><span class="nf">names</span><span class="p">(</span><span class="n">popColours</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sapply</span><span class="p">(</span><span class="n">imPopMap</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="o">$</span><span class="n">path</span><span class="p">})</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">phenotypes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="n">spe</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="o">$</span><span class="n">Phenotype</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">popColours</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">popColours</span><span class="p">[</span><span class="nf">names</span><span class="p">(</span><span class="n">popColours</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">phenotypes</span><span class="p">]</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># plot populations</span>
<span class="linenos">11</span><span class="n">SPIAT</span><span class="o">::</span><span class="nf">plot_cell_categories</span><span class="p">(</span><span class="n">spe</span><span class="o">$</span><span class="n">NjumBK</span><span class="p">,</span><span class="w"> </span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="n">popColours</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Phenotype&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">12</span><span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="n">.</span><span class="o">~</span><span class="n">Phenotype</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_spiat_NjumBK_map.png"><img alt="_images/others_spiat_NjumBK_map.png" src="_images/others_spiat_NjumBK_map.png" style="width: 100%;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># get entropies</span>
<span class="linenos"> 2</span><span class="n">gradient_pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1"># radii</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">spiat.entropies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">spe</span><span class="p">[</span><span class="nf">names</span><span class="p">(</span><span class="n">spe</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;NjumBK&quot;</span><span class="p">],</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 5</span><span class="w">  </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">SPIAT</span><span class="o">::</span><span class="nf">entropy_gradient_aggregated</span><span class="p">(</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">cell_types_of_interest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pops</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="n">feature_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Phenotype&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">radii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gradient_pos</span><span class="p">)</span><span class="o">$</span><span class="n">gradient_df</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="p">})</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">entropiesDT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbindlist</span><span class="p">(</span><span class="n">spiat.entropies</span><span class="p">,</span><span class="w"> </span><span class="n">idcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;uID&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">datToPlot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">entropiesDT</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="linenos"> 2</span><span class="w">  </span><span class="nf">pivot_longer</span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">starts_with</span><span class="p">(</span><span class="s">&quot;Pos_&quot;</span><span class="p">),</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;radius&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="n">names_pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.*_(.*)&quot;</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;value&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="linenos"> 7</span><span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">radius</span><span class="p">))</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">datToPlot</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Celltype2</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Celltype2</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Celltype2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">10</span><span class="w">  </span><span class="nf">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">11</span><span class="w">  </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">12</span><span class="w">  </span><span class="c1"># geom_smooth() +</span>
<span class="linenos">13</span><span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">uID</span><span class="o">~</span><span class="n">Celltype1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">14</span><span class="w">  </span><span class="nf">scale_color_brewer</span><span class="p">(</span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set1&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">15</span><span class="w">  </span><span class="nf">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_spiat_NjumBK_entropy.png"><img alt="_images/others_spiat_NjumBK_entropy.png" src="_images/others_spiat_NjumBK_entropy.png" style="width: 100%;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Normalized mixing score (NMS)</span>
<span class="linenos"> 2</span><span class="n">target_pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pops</span><span class="p">[</span><span class="n">pops</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;/nonDebris/P14&quot;</span><span class="p">]</span>
<span class="linenos"> 3</span><span class="n">spiat.nms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">target_pops</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 4</span><span class="w">  </span><span class="n">nsm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">spe</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">SPIAT</span><span class="o">::</span><span class="nf">mixing_score_summary</span><span class="p">(</span>
<span class="linenos"> 6</span><span class="w">      </span><span class="n">spe_object</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="w">      </span><span class="n">reference_celltype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/nonDebris/P14&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="w">      </span><span class="n">target_celltype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="linenos"> 9</span><span class="w">      </span><span class="n">feature_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Phenotype&quot;</span><span class="p">))</span>
<span class="linenos">10</span><span class="w">  </span><span class="p">})</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="w">  </span><span class="nf">rbindlist</span><span class="p">(</span><span class="n">nsm</span><span class="p">,</span><span class="w"> </span><span class="n">idcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;uID&quot;</span><span class="p">)</span>
<span class="linenos">13</span><span class="p">})</span>
<span class="linenos">14</span><span class="nf">names</span><span class="p">(</span><span class="n">spiat.nms</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">target_pops</span>
<span class="linenos">15</span><span class="n">spiat.nmsDT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbindlist</span><span class="p">(</span><span class="n">spiat.nms</span><span class="p">,</span><span class="w"> </span><span class="n">idcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;target&quot;</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">spiat.nmsDT</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">Normalised_mixing_score</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">18</span><span class="w">  </span><span class="nf">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">19</span><span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">outlier.alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">20</span><span class="w">  </span><span class="nf">geom_jitter</span><span class="p">(</span>
<span class="linenos">21</span><span class="w">    </span><span class="c1"># position = position_jitterdodge(jitter.width = 0.10), alpha = 1.0) +</span>
<span class="linenos">22</span><span class="w">    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">23</span><span class="w">  </span><span class="nf">coord_flip</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_spiat_nms.png"><img alt="_images/others_spiat_nms.png" src="_images/others_spiat_nms.png" style="width: 50%;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Cross-K AUC</span>
<span class="linenos"> 2</span><span class="n">spiat.auc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">target_pops</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 3</span><span class="w">  </span><span class="n">auc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">spe</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="n">SPIAT</span><span class="o">::</span><span class="nf">AUC_of_cross_function</span><span class="p">(</span><span class="n">SPIAT</span><span class="o">::</span><span class="nf">calculate_cross_functions</span><span class="p">(</span>
<span class="linenos"> 5</span><span class="w">      </span><span class="n">spe_object</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="w">      </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Kcross&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cell_types_of_interest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;/nonDebris/P14&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">),</span>
<span class="linenos"> 7</span><span class="w">      </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="w">      </span><span class="n">feature_colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Phenotype&quot;</span><span class="p">))</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="p">})</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="w">  </span><span class="n">DT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">unlist</span><span class="p">(</span><span class="n">auc</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">rownames_to_column</span><span class="p">())</span>
<span class="linenos">12</span><span class="w">  </span><span class="nf">colnames</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;uID&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;value&quot;</span><span class="p">)</span>
<span class="linenos">13</span><span class="w">  </span><span class="n">DT</span>
<span class="linenos">14</span><span class="p">})</span>
<span class="linenos">15</span><span class="nf">names</span><span class="p">(</span><span class="n">spiat.auc</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">target_pops</span>
<span class="linenos">16</span><span class="n">spiat.aucDT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbindlist</span><span class="p">(</span><span class="n">spiat.auc</span><span class="p">,</span><span class="w"> </span><span class="n">idcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;target&quot;</span><span class="p">)</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">spiat.aucDT</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">19</span><span class="w">  </span><span class="nf">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">20</span><span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">outlier.alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">21</span><span class="w">  </span><span class="nf">geom_jitter</span><span class="p">(</span>
<span class="linenos">22</span><span class="w">    </span><span class="c1"># position = position_jitterdodge(jitter.width = 0.10), alpha = 1.0) +</span>
<span class="linenos">23</span><span class="w">    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">24</span><span class="w">  </span><span class="nf">coord_flip</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_spiat_auc.png"><img alt="_images/others_spiat_auc.png" src="_images/others_spiat_auc.png" style="width: 50%;" /></a>
</section>
<section id="spatstat">
<h3>spatstat<a class="headerlink" href="#spatstat" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/spatstat/spatstat">spatstat</a> is a collection of R-packages that enable
complex analysis of spatial patterns. To illustrate how to work with this package
we are using the same dataset as for <cite>SPIAT</cite> above.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nf">library</span><span class="p">(</span><span class="n">cecelia</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="nf">cciaUse</span><span class="p">(</span><span class="s">&quot;~/cecelia&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># init ccia object</span>
<span class="linenos"> 5</span><span class="n">cciaObj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">initCciaObject</span><span class="p">(</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="n">pID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="n">uID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;6QzZsl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">versionID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">versionID</span><span class="p">,</span><span class="w"> </span><span class="n">initReactivity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span>
<span class="linenos"> 7</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">exp.info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">summary</span><span class="p">(</span><span class="n">withSelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Attr&quot;</span><span class="p">)))</span>
<span class="linenos">10</span><span class="n">uIDs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">exp.info</span><span class="o">$</span><span class="n">uID</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># get pops</span>
<span class="linenos">13</span><span class="n">pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">popPaths</span><span class="p">(</span><span class="n">popType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;flow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">includeFiltered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">uIDs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uIDs</span><span class="p">[</span><span class="m">1</span><span class="p">])</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1"># # exclude &#39;O&#39; pops</span>
<span class="linenos">16</span><span class="n">pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pops</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="nf">str_match</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/O[0-9]*$&quot;</span><span class="p">))]</span>
<span class="linenos">17</span><span class="n">pops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pops</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="nf">str_match</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/nonDebris$&quot;</span><span class="p">))]</span>
<span class="linenos">18</span><span class="n">windowPops</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;root&quot;</span><span class="p">)</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1"># get ppp for all populations</span>
<span class="linenos">21</span><span class="n">popPPP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">22</span><span class="w">  </span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">ppp</span><span class="p">(</span>
<span class="linenos">23</span><span class="w">    </span><span class="n">popType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;flow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">uIDs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uIDs</span><span class="p">,</span><span class="w"> </span><span class="n">usePhysicalScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">windowPops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windowPops</span><span class="p">)</span>
<span class="linenos">24</span><span class="p">})</span>
<span class="linenos">25</span><span class="nf">names</span><span class="p">(</span><span class="n">popPPP</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pops</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># plot populations out</span>
<span class="linenos">2</span><span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">))</span>
<span class="linenos">3</span><span class="nf">plot</span><span class="p">(</span><span class="n">popPPP</span><span class="o">$</span><span class="n">`/nonDebris/O/B220`</span><span class="o">$</span><span class="n">NjumBK</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;B220&quot;</span><span class="p">)</span>
<span class="linenos">4</span><span class="nf">plot</span><span class="p">(</span><span class="n">popPPP</span><span class="o">$</span><span class="n">`/nonDebris/O/O1/CD3`</span><span class="o">$</span><span class="n">NjumBK</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CD3&quot;</span><span class="p">)</span>
<span class="linenos">5</span><span class="nf">plot</span><span class="p">(</span><span class="n">popPPP</span><span class="o">$</span><span class="n">`/nonDebris/O/LCMV`</span><span class="o">$</span><span class="n">NjumBK</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;LCMV&quot;</span><span class="p">)</span>
<span class="linenos">6</span><span class="nf">plot</span><span class="p">(</span><span class="n">popPPP</span><span class="o">$</span><span class="n">`/nonDebris/XCR1`</span><span class="o">$</span><span class="n">NjumBK</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;XCR1&quot;</span><span class="p">)</span>
<span class="linenos">7</span><span class="nf">plot</span><span class="p">(</span><span class="n">popPPP</span><span class="o">$</span><span class="n">`/nonDebris/P14`</span><span class="o">$</span><span class="n">NjumBK</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;P14&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_spat_NjumBK_maps.png"><img alt="_images/others_spat_NjumBK_maps.png" src="_images/others_spat_NjumBK_maps.png" style="width: 100%;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># test for spatial randomness</span>
<span class="linenos">2</span><span class="n">ce.results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span>
<span class="linenos">3</span><span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">popPPP</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">4</span><span class="w">  </span><span class="nf">message</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;&gt;&gt; Test CSR for&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>
<span class="linenos">5</span><span class="w">  </span><span class="c1"># test for randomness</span>
<span class="linenos">6</span><span class="w">  </span><span class="n">ce.results</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">unlist</span><span class="p">(</span><span class="n">parallel</span><span class="o">::</span><span class="nf">mclapply</span><span class="p">(</span><span class="n">popPPP</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">7</span><span class="w">    </span><span class="n">spatstat.explore</span><span class="o">::</span><span class="nf">clarkevans.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MonteCarlo&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nsim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99</span><span class="p">)</span><span class="o">$</span><span class="n">statistic</span>
<span class="linenos">8</span><span class="w">  </span><span class="p">}))</span>
<span class="linenos">9</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># plot out</span>
<span class="linenos"> 2</span><span class="n">cdDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">ce.results</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="nf">colnames</span><span class="p">(</span><span class="n">cdDF</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stringr</span><span class="o">::</span><span class="nf">str_extract</span><span class="p">(</span><span class="nf">colnames</span><span class="p">(</span><span class="n">cdDF</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;(?&lt;=\\.)[^\\.]*$&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="nf">rownames</span><span class="p">(</span><span class="n">cdDF</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stringr</span><span class="o">::</span><span class="nf">str_extract</span><span class="p">(</span><span class="nf">rownames</span><span class="p">(</span><span class="n">cdDF</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;.+(?=\\.R)&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">cdDF</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">pivot_longer</span><span class="p">(</span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">everything</span><span class="p">(),</span><span class="w"> </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pop&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ce&quot;</span><span class="p">),</span>
<span class="linenos"> 7</span><span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">ce</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="nf">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">outlier.alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">10</span><span class="w">  </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">11</span><span class="w">  </span><span class="nf">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_spat_ce_results.png"><img alt="_images/others_spat_ce_results.png" src="_images/others_spat_ce_results.png" style="width: 40%;" /></a>
</section>
<section id="celltrackr">
<h3>celltrackR<a class="headerlink" href="#celltrackr" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/ingewortel/celltrackR">celltrackR</a> is an R-package to facilitate
analysis of cell tracks. Here we are using the <a class="reference internal" href="msn_ln_HSV.html#msn-ln-hsv"><span class="std std-ref">Mouse lymph node HSV infection</span></a> dataset to
illustrate its basic usage in the context of <cite>Cecelia</cite>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nf">library</span><span class="p">(</span><span class="n">cecelia</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="nf">cciaUse</span><span class="p">(</span><span class="s">&quot;~/cecelia&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># init ccia object</span>
<span class="linenos"> 5</span><span class="n">cciaObj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">initCciaObject</span><span class="p">(</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="n">pID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pID</span><span class="p">,</span><span class="w"> </span><span class="n">uID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rXctjl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">versionID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">versionID</span><span class="p">,</span><span class="w"> </span><span class="n">initReactivity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span>
<span class="linenos"> 7</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1"># get experimental info</span>
<span class="linenos">10</span><span class="n">exp.info</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.table</span><span class="p">(</span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">summary</span><span class="p">(</span>
<span class="linenos">11</span><span class="w">  </span><span class="n">withSelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Attr&quot;</span><span class="p">)</span>
<span class="linenos">12</span><span class="p">))</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">uIDs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">exp.info</span><span class="p">[</span><span class="n">Cells</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;gDT_gBT&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">Include</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Y&quot;</span><span class="p">]</span><span class="o">$</span><span class="n">uID</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1"># get tracks for analysis</span>
<span class="linenos">17</span><span class="n">tracks.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span>
<span class="linenos">18</span><span class="w">  </span><span class="nf">list</span><span class="p">(</span><span class="n">gBT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;gBT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">gDT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;gDT&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">cciaObj</span><span class="o">$</span><span class="nf">tracks</span><span class="p">(</span><span class="n">pop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">uIDs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uIDs</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># plot out tracks</span>
<span class="linenos">2</span><span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>
<span class="linenos">3</span><span class="nf">plot</span><span class="p">(</span><span class="n">tracks.list</span><span class="o">$</span><span class="n">gBT</span><span class="o">$</span><span class="n">fizPPH</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Uninf gBT&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># Uninf</span>
<span class="linenos">4</span><span class="nf">plot</span><span class="p">(</span><span class="n">tracks.list</span><span class="o">$</span><span class="n">gDT</span><span class="o">$</span><span class="n">fizPPH</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Uninf gDT&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># Uninf</span>
<span class="linenos">5</span><span class="nf">plot</span><span class="p">(</span><span class="n">tracks.list</span><span class="o">$</span><span class="n">gBT</span><span class="o">$</span><span class="n">`2nFwDR`</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1 dpi gBT&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># dpi 1</span>
<span class="linenos">6</span><span class="nf">plot</span><span class="p">(</span><span class="n">tracks.list</span><span class="o">$</span><span class="n">gDT</span><span class="o">$</span><span class="n">`2nFwDR`</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1 dpi gDT&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># dpi 1</span>
<span class="linenos">7</span><span class="nf">plot</span><span class="p">(</span><span class="n">tracks.list</span><span class="o">$</span><span class="n">gBT</span><span class="o">$</span><span class="n">LfVNe6</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2 dpi gBT&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># dpi 2</span>
<span class="linenos">8</span><span class="nf">plot</span><span class="p">(</span><span class="n">tracks.list</span><span class="o">$</span><span class="n">gDT</span><span class="o">$</span><span class="n">LfVNe6</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2 dpi gDT&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># dpi 2</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_celltrackR_tracks.png"><img alt="_images/others_celltrackR_tracks.png" src="_images/others_celltrackR_tracks.png" style="width: 100%;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># get normalised tracks to plot</span>
<span class="linenos"> 2</span><span class="n">tracks.DT.norm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tracks.combine.dt</span><span class="p">(</span><span class="nf">lapply</span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">  </span><span class="n">tracks.list</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">tracks.apply.fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">celltrackR</span><span class="o">::</span><span class="n">normalizeTracks</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="p">))</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">tracks.DT.norm</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">left_join</span><span class="p">(</span><span class="n">exp.info</span><span class="p">),</span>
<span class="linenos"> 7</span><span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">interaction</span><span class="p">(</span><span class="n">uID</span><span class="p">,</span><span class="w"> </span><span class="n">track_id</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="c1"># geom_point(size = 0.5) +</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="nf">geom_path</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">10</span><span class="w">  </span><span class="nf">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">11</span><span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">cell_type</span><span class="o">~</span><span class="n">dpi</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">12</span><span class="w">  </span><span class="nf">theme</span><span class="p">(</span>
<span class="linenos">13</span><span class="w">    </span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p">,</span>
<span class="linenos">14</span><span class="w">    </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="linenos">16</span><span class="w">    </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="linenos">17</span><span class="w">    </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="linenos">18</span><span class="w">    </span><span class="n">axis.ticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="linenos">19</span><span class="w">    </span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="linenos">20</span><span class="w">    </span><span class="c1"># strip.text.x = element_blank(),</span>
<span class="linenos">21</span><span class="w">    </span><span class="n">axis.line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">()</span>
<span class="linenos">22</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">coord_fixed</span><span class="p">(</span><span class="n">ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_celltrackR_stars.png"><img alt="_images/others_celltrackR_stars.png" src="_images/others_celltrackR_stars.png" style="width: 100%;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># compare msd on plot</span>
<span class="linenos"> 2</span><span class="n">tracks.DT.msd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tracks.combine.dt</span><span class="p">(</span><span class="nf">lapply</span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">  </span><span class="n">tracks.list</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">tracks.aggregate.fun</span><span class="p">(</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">celltrackR</span><span class="o">::</span><span class="n">squareDisplacement</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="n">summary.FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mean.se&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">add.time.delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="n">subtracks.i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="p">)</span>
<span class="linenos"> 8</span><span class="p">))</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># focus specific images</span>
<span class="linenos">11</span><span class="n">plot.uIDs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;LfVNe6&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2nFwDR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fizPPH&quot;</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># plot</span>
<span class="linenos">14</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">tracks.DT.msd</span><span class="p">[</span><span class="n">uID</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">plot.uIDs</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">left_join</span><span class="p">(</span><span class="n">exp.info</span><span class="p">),</span>
<span class="linenos">15</span><span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cell_type</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cell_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">16</span><span class="w">  </span><span class="nf">geom_ribbon</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lower</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upper</span><span class="p">),</span>
<span class="linenos">17</span><span class="w">              </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">18</span><span class="w">  </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">19</span><span class="w">  </span><span class="nf">labs</span><span class="p">(</span>
<span class="linenos">20</span><span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">Delta</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;t (steps)&quot;</span><span class="p">)),</span>
<span class="linenos">21</span><span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MSD&quot;</span>
<span class="linenos">22</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">23</span><span class="w">  </span><span class="nf">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">24</span><span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">dpi</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">25</span><span class="w">  </span><span class="nf">scale_color_brewer</span><span class="p">(</span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set2&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">26</span><span class="w">  </span><span class="nf">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set2&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">27</span><span class="w">  </span><span class="nf">theme</span><span class="p">(</span>
<span class="linenos">28</span><span class="w">    </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="linenos">29</span><span class="w">    </span><span class="n">strip.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">()</span>
<span class="linenos">30</span><span class="w">  </span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/others_celltrackR_msd.png"><img alt="_images/others_celltrackR_msd.png" src="_images/others_celltrackR_msd.png" style="width: 100%;" /></a>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Changelog</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="access_data_rmarkdown.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Access data in RMarkdown</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Dominik Schienstock
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Connecting other packages</a><ul>
<li><a class="reference internal" href="#r-packages">R packages</a><ul>
<li><a class="reference internal" href="#spiat">SPIAT</a></li>
<li><a class="reference internal" href="#spatstat">spatstat</a></li>
<li><a class="reference internal" href="#celltrackr">celltrackR</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=e031e9a9"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>